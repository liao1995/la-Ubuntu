WEBVTT

1
00:00:00.000 --> 00:00:03.162
在这段视频中我想谈谈正规方程 ( normal equation )

2
00:00:03.162 --> 00:00:05.212
以及它们的不可逆性

3
00:00:05.212 --> 00:00:07.877
由于这是一种较为深入的概念

4
00:00:07.877 --> 00:00:10.289
并且总有人问我有关这方面的问题

5
00:00:10.289 --> 00:00:12.711
因此 我想在这里来讨论它

6
00:00:12.711 --> 00:00:14.752
由于概念较为深入

7
00:00:14.752 --> 00:00:17.982
所以对这段可选材料大家放轻松吧

8
00:00:17.982 --> 00:00:22.413
也许你可能会深入地探索下去

9
00:00:22.413 --> 00:00:24.416
并且会觉得理解以后会非常有用

10
00:00:24.416 --> 00:00:26.619
但即使你没有理解

11
00:00:26.619 --> 00:00:28.450
正规方程和线性回归的关系

12
00:00:28.450 --> 00:00:30.539
也没有关系

13
00:00:30.539 --> 00:00:33.195
我们要讲的问题如下

14
00:00:33.195 --> 00:00:35.691
你或许可能对

15
00:00:35.691 --> 00:00:37.876
线性代数比较熟悉

16
00:00:37.876 --> 00:00:39.884
有些同学曾经问过我

17
00:00:39.884 --> 00:00:42.542
当计算

18
00:00:42.542 --> 00:00:45.130
θ等于inv(X'X ) X'y （注：X的转置翻译为X'，下同）

19
00:00:45.130 --> 00:00:49.476
那对于矩阵X'X的结果是不可逆的情况咋办呢?

20
00:00:49.476 --> 00:00:52.336
如果你懂一点线性代数的知识

21
00:00:52.336 --> 00:00:55.171
你或许会知道

22
00:00:55.171 --> 00:00:58.598
有些矩阵可逆 而有些矩阵不可逆

23
00:00:58.598 --> 00:01:00.540
我们称那些不可逆矩阵为

24
00:01:00.540 --> 00:01:04.737
奇异或退化矩阵

25
00:01:04.737 --> 00:01:08.893
问题的重点在于X'X的不可逆的问题

26
00:01:08.893 --> 00:01:11.287
很少发生

27
00:01:11.287 --> 00:01:16.749
在Octave里 如果你用它来实现θ的计算

28
00:01:16.749 --> 00:01:20.636
你将会得到一个正常的解

29
00:01:20.636 --> 00:01:24.629
在这里我不想赘述

30
00:01:24.629 --> 00:01:28.207
在Octave里 有两个函数可以求解矩阵的逆

31
00:01:28.207 --> 00:01:32.146
一个被称为pinv() 另一个是inv()

32
00:01:32.146 --> 00:01:36.089
这两者之间的差异是些许计算过程上的

33
00:01:36.089 --> 00:01:38.107
一个是所谓的伪逆 另一个被称为逆

34
00:01:38.107 --> 00:01:42.658
使用pinv() 函数可以展现数学上的过程

35
00:01:42.658 --> 00:01:47.145
这将计算出θ的值

36
00:01:47.145 --> 00:01:51.227
即便矩阵X'X是不可逆的

37
00:01:51.227 --> 00:01:54.095
在pinv() 和 inv() 之间

38
00:01:54.095 --> 00:01:55.959
又有哪些具体区别呢 ?

39
00:01:55.959 --> 00:01:58.562
其中inv() 引入了先进的数值计算的概念

40
00:01:58.562 --> 00:02:00.907
我真的不希望讲那些

41
00:02:00.907 --> 00:02:02.993
因此 我认为

42
00:02:02.993 --> 00:02:04.672
可以试着给你一点点直观的参考

43
00:02:04.672 --> 00:02:08.823
关于矩阵X'X的不可逆的问题

44
00:02:08.823 --> 00:02:12.108
如果你懂一点线性代数

45
00:02:12.108 --> 00:02:13.556
或许你可能会感兴趣

46
00:02:13.556 --> 00:02:15.948
我不会从数学的角度来证明它

47
00:02:15.948 --> 00:02:18.684
但如果矩阵X'X结果是不可逆的

48
00:02:18.684 --> 00:02:22.596
通常有两种最常见的原因

49
00:02:22.596 --> 00:02:26.238
第一个原因是 如果不知何故 在你的学习问题

50
00:02:26.238 --> 00:02:28.461
你有多余的功能

51
00:02:28.461 --> 00:02:30.844
例如 在预测住房价格时

52
00:02:30.844 --> 00:02:34.877
如果x1是以英尺为尺寸规格计算的房子

53
00:02:34.877 --> 00:02:37.792
x2是以平方米为尺寸规格计算的房子

54
00:02:37.792 --> 00:02:46.071
同时 你也知道1米等于3.28英尺 ( 四舍五入到两位小数 )

55
00:02:46.071 --> 00:02:48.947
这样 你的这两个特征值将始终满足约束

56
00:02:48.947 --> 00:02:55.378
x1等于x2倍的3.28平方

57
00:02:55.378 --> 00:02:59.107
并且你可以将这过程显示出来 讲到这里 可能 或许对你来说有点难了

58
00:02:59.107 --> 00:03:01.169
但如果你在线性代数上非常熟练

59
00:03:01.169 --> 00:03:05.275
实际上 你可以用这样的一个线性方程 来展示那两个相关联的特征值

60
00:03:05.275 --> 00:03:09.095
矩阵X'X将是不可逆的

61
00:03:09.095 --> 00:03:13.320
第二个原因是 在你想用大量的特征值

62
00:03:13.320 --> 00:03:17.043
尝试实践你的学习算法的时候

63
00:03:17.043 --> 00:03:18.850
可能会导致矩阵X'X的结果是不可逆的

64
00:03:18.850 --> 00:03:23.035
具体地说 在m小于或等于n的时候

65
00:03:23.035 --> 00:03:27.723
例如 有m等于10个的训练样本

66
00:03:27.723 --> 00:03:31.192
也有n等于100的特征数量

67
00:03:31.192 --> 00:03:36.829
要找到适合的 ( n +1 ) 维参数矢量θ 这是第 n+1 维

68
00:03:36.829 --> 00:03:39.308
这将会变成一个101维的矢量

69
00:03:39.308 --> 00:03:43.602
尝试从10个训练样本中找到满足101个参数的值

70
00:03:43.602 --> 00:03:46.899
这工作可能会让你花上一阵子时间

71
00:03:46.899 --> 00:03:49.078
但这并不总是一个好主意

72
00:03:49.078 --> 00:03:52.212
因为 正如我们所看到 你只有10个样本  以适应这100或101个参数

73
00:03:52.212 --> 00:03:58.432
数据还是有些少

74
00:03:58.432 --> 00:04:01.924
稍后我们将看到

75
00:04:01.924 --> 00:04:04.418
如何使用小数据样本以得到这100或101个参数

76
00:04:04.418 --> 00:04:07.544
通常 我们会使用一种叫做正则化的线性代数方法

77
00:04:07.544 --> 00:04:12.513
通过删除某些特征或者是使用某些技术

78
00:04:12.513 --> 00:04:14.689
来解决当m比n小的时候的问题

79
00:04:14.689 --> 00:04:17.477
这也是在本节课后面要讲到的内容

80
00:04:17.477 --> 00:04:21.905
即使你有一个相对较小的训练集

81
00:04:21.905 --> 00:04:24.117
也可使用很多的特征来找到很多合适的参数

82
00:04:24.117 --> 00:04:27.698
有关正规化的内容将是本节之后课程的话题

83
00:04:27.698 --> 00:04:32.628
总之当你发现的矩阵X'X的结果是奇异矩阵

84
00:04:32.628 --> 00:04:35.877
或者找到的其它矩阵是不可逆的

85
00:04:35.877 --> 00:04:38.380
我会建议你这么做

86
00:04:38.380 --> 00:04:42.016
首先 看特征值里是否有一些多余的特征

87
00:04:42.016 --> 00:04:45.304
像这些x1和x2是线性相关的

88
00:04:45.304 --> 00:04:48.017
或像这样 互为线性函数

89
00:04:48.017 --> 00:04:49.841
同时 当有一些多余的特征时

90
00:04:49.841 --> 00:04:51.493
可以删除这两个重复特征里的其中一个

91
00:04:51.493 --> 00:04:53.724
无须两个特征同时保留

92
00:04:53.724 --> 00:04:55.601
所以 发现多余的特征删除二者其一

93
00:04:55.601 --> 00:04:58.586
将解决不可逆性的问题

94
00:04:58.586 --> 00:05:02.655
因此 首先应该通过观察所有特征检查是否有多余的特征

95
00:05:02.655 --> 00:05:05.481
如果有多余的就删除掉

96
00:05:05.481 --> 00:05:07.659
直到他们不再是多余的为止

97
00:05:07.659 --> 00:05:09.799
如果特征里没有多余的

98
00:05:09.799 --> 00:05:11.939
我会检查是否有过多的特征

99
00:05:11.939 --> 00:05:13.638
如果特征数量实在太多

100
00:05:13.638 --> 00:05:16.140
我会删除些 用较少的特征来反映尽可能多内容

101
00:05:16.140 --> 00:05:20.708
否则我会考虑使用正规化方法

102
00:05:20.708 --> 00:05:22.821
这也是我们将要谈论的话题

103
00:05:22.821 --> 00:05:27.877
同时 这也是有关标准方程的内容

104
00:05:27.877 --> 00:05:31.885
如果矩阵X'X是不可逆的

105
00:05:31.885 --> 00:05:35.710
通常来说 不会出现这种情况

106
00:05:35.710 --> 00:05:40.554
如果在Octave里

107
00:05:40.554 --> 00:05:42.853
可以用伪逆函数pinv ( ) 来实现

108
00:05:42.853 --> 00:05:46.700
这种使用不同的线性代数库的方法被称为伪逆

109
00:05:46.700 --> 00:05:50.071
即使X'X的结果是不可逆的

110
00:05:50.071 --> 00:05:52.582
但算法执行的流程是正确的

111
00:05:52.582 --> 00:05:55.198
总之 出现不可逆矩阵的情况极少发生

112
00:05:55.198 --> 99:59:59.000
所以在大多数实现线性回归中 出现不可逆的问题不应该过多的关注 【教育无边界字幕组】翻译：Yuens  校对、审核：Naplessss